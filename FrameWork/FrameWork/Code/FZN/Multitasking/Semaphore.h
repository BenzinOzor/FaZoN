//------------------------------------------------------------------------
//Author : Philippe OFFERMANN
//Date : 28.10.14
//Description : Custom semaphore class
//------------------------------------------------------------------------

#ifndef _SEMAPHORE_H_
#define _SEMAPHORE_H_


namespace fzn
{
	class FZN_EXPORT Semaphore
	{
	public:
		/////////////////CONSTRUCTORS / DESTRUCTORS/////////////////

		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		//Default constructor
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		Semaphore();
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		//Parametered constructor
		//Parameter 1 : Initial ticket count
		//Parameter 2 : Maximum ticket count
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		Semaphore(LONG initCount, LONG maxCount);
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		//Destructor
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		~Semaphore();


		/////////////////LOCK MANAGEMENT/////////////////

		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		//Locks the semaphore
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		DWORD Lock();
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		//Locks the semaphore
		//Parameter : Time to wait
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		DWORD Lock(DWORD _time);
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		//Unlocks the semaphore
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		INT8 Unlock();
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		//Unlocks the semaphore
		//Parameter : Number of tickets to give back to the semaphore
		//------------------------------------------------------------------------------------------------------------------------------------------------------------------
		INT8 Unlock(LONG _releaseCount);

		UINT m_ticket;
	private:
		HANDLE m_semaphore;
	};
} //namespace fzn

#endif //_SEMAPHORE_H_